# 数据收集及处理

在系统构建的时候免不了需要灌入大量的初始数据，本文将基于个人在工作中总结出的经验，给出数据收集的流程，数据处理程序的结构及常见问题的说明。只是一些浅显的见解，还需要更多的经验。

文档结构：

<!-- TOC -->

- [数据收集及处理](#数据收集及处理)
    - [数据收集流程](#数据收集流程)
        - [直接获取数据](#直接获取数据)
        - [主动收集数据](#主动收集数据)
        - [强调说明](#强调说明)

<!-- /TOC -->

## 数据收集流程

根据特定情景的不同，数据收集可以分为两类：

1. 直接获取数据：需求方已经有数据的积累，多是使用Excel表格存储管理，有些甚至是使用Word画的表格进行存储管理。
2. 主动收集数据：需求方没有数据积累或者只有少量的积累，需要根据需求方的要求和资源去收集数据。

### 直接获取数据

此类情况的数据一般存在以下问题：

1. 字段名称不一致，如：“email”，“邮箱”，“电子邮箱”；
2. 信息描述方式不一致，如“地址，“住宅地址”，“工作单位地址”，“工作单位”；
3. 同字段信息填写不一致，比如生日有的填写到月有的到日，有的是中文数字有的是阿拉伯数字；比如工作单位，有的是中文，有的是英文，有的是缩写；
4. 多个信息填写的问题，比如一个人有多个邮箱，有的是在同一个单元格中使用回车区分，有的使用email1，email2两列进行区分；
5. 信息错位的问题。

这些问题的处理不再本文的范围之内，会在别的文章中再做详述。

此类情况的处理流程为：

TODO：流程图

<!-- ！！！了解数据情况 -->
1. 获取并获取所有数据中的字段名及其覆盖率；
2. 分析字段的情况，如果有字段名称不一致的问题则需要确认主要使用字段并构建字段映射表；如果有多种不同类型的表还需要找出其中的关联并确保字段的一致性；
3. 根据字段覆盖率确认哪些是重要字段（必须存在或者具有主键作用的），哪些是次要的（可以不存在数据的），哪些是不需要的；
4. 根据确认的重要字段查看信息的完整度情况（比如，重要字段全都存在的数据量）；

<!-- ！！！确认存储策略 -->
5. 确认存储结构，尽量不丢失信息
6. 确认字段存贮策略（特别注意查重策略，合并策略）。特别是信息描述不一致的问题，如果不易处理，需要人工参与（此处需要与数据使用方进行沟通）；
7. 根据存储策略查看损失数据情况，根据接收程度动态调整“重要字段”、“存储结构”和“存储策略”；
8. 最后给出“数据库字段说明文档”和“字段处理策略文档”；

### 主动收集数据

此类情况问题一般存在以下问题：

1. 收集表的字段设计问题：
   - 字段描述模糊，如：报名时间，该字段的含义包含两部分“报名开始时间”和“报名结束时间”，稳妥起见应该拆分成两个字段
   - 没有添加数据验证，比如：性别，民族等因该提供下拉表格，以防填写数据格式不一致；出现不可能的时间比如20190230，出现截止时间小于开始时间；时间填写格式不一致，有的填写到日，有的填写到月，有的使用`-`分隔年月日，有的使用`/`，有的直接写2019年9月1日

2. 不同类型的表格，关联信息不一致，比如一个表的公司名称使用全称，另一个表的名称使用简称

这些问题的处理不再本文的范围之内，会在别的文章中再做详述。

此类问题，如果时间和条件允许，应该构建一个信息管理系统，一个登录页，一个注册页和一个信息更新的页面就可以很好的解决该类问题了。但是时间和条件不允许的化，那么就需要使用Excel表采集的方式了：

此类问题的处理流程为：

TODO：流程图

<!-- 收集前 -->
1. 确认收集数据的字段及其类型，根据需求的不同坑会需要字段的中文翻译；
2. 确认字段的重要程度，是否为必填字段，或是选填字段（虽然可以在收集完成之后根据字段覆盖率确定，但是避免产生无效收集的数据，最好提前确定）
3. 表格设计，每一列的信息都是独立的，清晰的，易处理的；根据字段的需要进行数据验证的设置（内容的形式，如时间格式；填写内容的范围，如性别，民族）。根据需求方的使用场景不同，还可能会有表头的需求；

<!-- 收集后 -->
4. 收集完成后，获取字段覆盖率，信息完整度（有效填写信息数量）；
5. 确认字段存贮策略（特别注意查重策略，合并策略）；
6. 如果收集前准备充分，收集中严格执行，那么可以直接入库；
7. 如果依然存在问题，需要根据情况不断调整字段存贮策略。如果存在不易处理的数据，则需要人工协助。
8. 最后给出“数据库字段说明文档（包字段数据验证要求）”和“字段处理策略文档”；

### 强调说明

确认字段重要程度步骤十分重要，必填字段会影响查重合并的质量，也会影响有效入库数据的数量；确认的过程不仅需要和需求方协商、确认，还需要和使用方协商、确认（特别是前端、处理流程下游人员）
